<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>악성코드 통합 분석 대시보드</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.2.0/crypto-js.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <!-- PDF Export Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gray-900 text-gray-200">

    <div class="flex h-screen">
        <!-- Sidebar -->
        <aside class="w-64 bg-gray-800 p-4 flex flex-col fixed h-full">
            <div class="flex items-center mb-8">
                <span class="text-2xl mr-2">🛡️</span>
                <h1 class="text-xl font-bold text-white">통합 분석 도구</h1>
            </div>
            <nav class="flex flex-col space-y-2">
                <a href="#" id="nav-scenario" class="nav-item active px-4 py-2 rounded-md">종합 시나리오 분석</a>
                <a href="#" id="nav-single" class="nav-item px-4 py-2 rounded-md">개별 파일 상세 분석</a>
                <a href="#" id="nav-yara" class="nav-item px-4 py-2 rounded-md">YARA 룰 관리 및 스캔</a>
            </nav>
            <div class="mt-auto p-4 bg-gray-900 rounded-lg">
                <p class="text-sm text-gray-400">
                    <i data-lucide="alert-triangle" class="inline-block w-4 h-4 mr-1 text-yellow-400"></i>
                    이 도구는 교육 및 훈련 목적으로 제작되었습니다. 실제 악성코드를 업로드하지 마세요.
                </p>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 ml-64 p-8 overflow-y-auto">
            <h1 class="text-3xl font-bold mb-2 text-white">악성코드 통합 분석 대시보드</h1>
            <p class="text-gray-400 mb-6">악성코드 시나리오의 각 단계별 산출물을 종합적으로 분석합니다.</p>
            <hr class="border-gray-700 mb-8">

            <!-- View: Comprehensive Scenario Analysis -->
            <div id="view-scenario">
                <h2 class="text-2xl font-semibold mb-6 flex items-center"><i data-lucide="network" class="w-6 h-6 mr-3 text-blue-400"></i>📈 종합 시나리오 분석</h2>

                <!-- Step 1 -->
                <div class="bg-gray-800 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-bold mb-4 text-white">1️⃣ 단계: 초기 침투 (Malicious Excel)</h3>
                    <div class="file-drop-zone border-2 border-dashed border-gray-600 rounded-lg p-6 text-center" id="drop-zone-xlsm">
                        <label for="file-xlsm" class="file-input-label cursor-pointer">
                             <i data-lucide="file-spreadsheet" class="mx-auto h-12 w-12 text-gray-400"></i>
                             <p class="mt-2 text-gray-400">훈련용 엑셀 파일(.xlsm)을 여기에 드래그하거나 클릭하여 업로드하세요.</p>
                             <input type="file" id="file-xlsm" class="hidden" accept=".xlsm">
                        </label>
                         <p id="filename-xlsm" class="mt-2 text-sm font-medium text-green-400"></p>
                    </div>
                    <div id="result-xlsm" class="mt-4"></div>
                </div>

                <!-- Step 2 -->
                <div class="bg-gray-800 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-bold mb-4 text-white">2️⃣ 단계: 악성 페이로드 실행 (Executable)</h3>
                     <div class="file-drop-zone border-2 border-dashed border-gray-600 rounded-lg p-6 text-center" id="drop-zone-exe">
                         <label for="file-exe" class="file-input-label cursor-pointer">
                             <i data-lucide="file-terminal" class="mx-auto h-12 w-12 text-gray-400"></i>
                             <p class="mt-2 text-gray-400">실행 파일(.exe)을 여기에 드래그하거나 클릭하여 업로드하세요.</p>
                             <input type="file" id="file-exe" class="hidden" accept=".exe, .dll">
                         </label>
                         <p id="filename-exe" class="mt-2 text-sm font-medium text-green-400"></p>
                    </div>
                    <div id="result-exe" class="mt-4"></div>
                </div>

                <!-- Step 3 -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <h3 class="text-lg font-bold mb-4 text-white">3️⃣ 단계: 정보 수집 및 유출 (Script & Log)</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div>
                             <div class="file-drop-zone border-2 border-dashed border-gray-600 rounded-lg p-6 text-center" id="drop-zone-ps1">
                                <label for="file-ps1" class="file-input-label cursor-pointer">
                                     <i data-lucide="file-code-2" class="mx-auto h-12 w-12 text-gray-400"></i>
                                     <p class="mt-2 text-gray-400">파워쉘 스크립트(.ps1) 업로드</p>
                                     <input type="file" id="file-ps1" class="hidden" accept=".ps1">
                                 </label>
                                 <p id="filename-ps1" class="mt-2 text-sm font-medium text-green-400"></p>
                            </div>
                            <div id="result-ps1" class="mt-4"></div>
                        </div>
                        <div>
                            <div class="file-drop-zone border-2 border-dashed border-gray-600 rounded-lg p-6 text-center" id="drop-zone-txt">
                                <label for="file-txt" class="file-input-label cursor-pointer">
                                     <i data-lucide="file-text" class="mx-auto h-12 w-12 text-gray-400"></i>
                                     <p class="mt-2 text-gray-400">결과 텍스트 파일(.txt) 업로드</p>
                                     <input type="file" id="file-txt" class="hidden" accept=".txt">
                                </label>
                                <p id="filename-txt" class="mt-2 text-sm font-medium text-green-400"></p>
                            </div>
                            <div id="result-txt" class="mt-4"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- View: Single File Detailed Analysis -->
            <div id="view-single" class="hidden">
                 <h2 class="text-2xl font-semibold mb-6 flex items-center"><i data-lucide="file-search" class="w-6 h-6 mr-3 text-green-400"></i>📂 개별 파일 상세 분석</h2>
                 <div class="bg-gray-800 rounded-lg p-6 mb-6">
                    <div class="file-drop-zone border-2 border-dashed border-gray-600 rounded-lg p-6 text-center" id="drop-zone-single">
                        <label for="file-single" class="file-input-label cursor-pointer">
                             <i data-lucide="upload-cloud" class="mx-auto h-12 w-12 text-gray-400"></i>
                             <p class="mt-2 text-gray-400">분석할 파일(.exe, .ps1, .txt, .xlsm)을 업로드하세요.</p>
                             <input type="file" id="file-single" class="hidden">
                        </label>
                        <p id="filename-single" class="mt-2 text-sm font-medium text-green-400"></p>
                    </div>
                 </div>
                 <div id="result-single" class="mt-4"></div>
            </div>
            
            <!-- View: YARA Rule Management & Scan -->
            <div id="view-yara" class="hidden">
                <h2 class="text-2xl font-semibold mb-6 flex items-center"><i data-lucide="shield-plus" class="w-6 h-6 mr-3 text-red-400"></i>🚨 YARA 룰 관리 및 스캔</h2>
                
                <!-- [Layout Change] Top Row for uploads -->
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <!-- Left: Rule Upload -->
                    <div class="bg-gray-800 rounded-lg p-6 flex flex-col">
                        <h3 class="text-lg font-bold mb-4 text-white">룰셋 추가 (.yar)</h3>
                        <div class="file-drop-zone border-2 border-dashed border-gray-600 rounded-lg p-6 text-center" id="drop-zone-yar">
                            <label for="file-yar" class="file-input-label cursor-pointer">
                                <i data-lucide="file-plus-2" class="mx-auto h-12 w-12 text-gray-400"></i>
                                <p class="mt-2 text-gray-400">추가할 YARA 룰 파일(.yar)을 업로드하세요.</p>
                                <input type="file" id="file-yar" class="hidden" accept=".yar, .yara">
                            </label>
                            <p id="filename-yar" class="mt-2 text-sm font-medium text-green-400"></p>
                        </div>
                        <button id="reset-yara-rules" class="mt-4 w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-lg transition">기본 룰셋으로 초기화</button>
                    </div>

                    <!-- Right: Scan Target -->
                    <div class="bg-gray-800 rounded-lg p-6 flex flex-col">
                        <h3 class="text-lg font-bold mb-4 text-white">스캔 대상 파일</h3>
                         <div class="file-drop-zone border-2 border-dashed border-gray-600 rounded-lg p-6 text-center" id="drop-zone-yara-target">
                            <label for="file-yara-target" class="file-input-label cursor-pointer">
                                 <i data-lucide="scan-line" class="mx-auto h-12 w-12 text-gray-400"></i>
                                 <p class="mt-2 text-gray-400">스캔할 파일을 업로드하세요.</p>
                                 <input type="file" id="file-yara-target" class="hidden">
                            </label>
                            <p id="filename-yara-target" class="mt-2 text-sm font-medium text-green-400"></p>
                        </div>
                        <button id="scan-btn-yara" class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition">스캔 실행</button>
                    </div>
                </div>

                <!-- [Layout Change] Full-width bottom section -->
                <!-- Applied Ruleset -->
                <div class="bg-gray-800 rounded-lg p-6 mb-6">
                    <h3 class="text-lg font-bold mb-2 text-white">적용된 YARA 룰셋</h3>
                    <p class="text-sm mb-4">현재 스캔에 사용될 룰 목록 (<span id="yara-source-name" class="font-semibold text-blue-400">기본 내장 룰</span>)</p>
                    
                    <div id="custom-rule-display" class="hidden mb-4">
                         <h4 class="text-md font-semibold mb-2 text-gray-300">로드된 커스텀 룰 파일</h4>
                         <div id="custom-rule-content" class="max-h-48 overflow-y-auto bg-gray-900 rounded-lg p-3 border border-gray-700 text-xs font-mono text-gray-300 whitespace-pre-wrap">
                         </div>
                    </div>
                    
                    <h4 class="text-md font-semibold mb-2 text-gray-300">스캔에 적용되는 룰 목록</h4>
                    <div id="yara-rules-accordion" class="max-h-96 overflow-y-auto">
                        <!-- YARA rules will be dynamically inserted here -->
                    </div>
                </div>

                <!-- Scan Results -->
                <div id="result-yara"></div>
            </div>
        </main>
    </div>

    <script src="script.js" defer></script>
</body>
</html>

